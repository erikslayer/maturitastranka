<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Vestavƒõn√© funkce MySQL - agregaƒçn√≠, ≈ôetƒõzcov√©, datumov√©.">
    <title>21. Vestavƒõn√© funkce MySQL - DB | Maturita Port√°l</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../../styles.css">
</head>

<body>
    <div class="container">
        <header>
            <a href="../../index.html" class="logo">MaturitaPort√°l</a>
            <nav>
                <ul>
                    <li><a href="../../index.html">Dom≈Ø</a></li>
                    <li><a href="../../literatura/index.html">Literatura</a></li>
                    <li><a href="../index.html" class="active">ICT</a></li>
                </ul>
            </nav>
        </header>
        <main>
            <nav class="breadcrumb">
                <a href="../../index.html">Dom≈Ø</a><span class="separator">‚Ä∫</span>
                <a href="../index.html">ICT</a><span class="separator">‚Ä∫</span>
                <a href="../db.html">Datab√°ze</a><span class="separator">‚Ä∫</span>
                <span class="current">Vestavƒõn√© funkce</span>
            </nav>
            <div class="book-header animate-fade-in">
                <h1>‚ö° Vestavƒõn√© funkce MySQL</h1>
                <p class="author">T√©ma 21 - Datab√°ze</p>
                <div class="meta">
                    <span class="meta-item">üíæ Datab√°ze</span>
                    <span class="meta-item">üìö Maturitn√≠ okruh</span>
                </div>
            </div>
            <div class="glass-panel animate-fade-in book-content">
                <h2>üìñ Co jsou vestavƒõn√© funkce?</h2>
                <p>Vestavƒõn√© funkce jsou <strong>p≈ôeddefinovan√© procedury</strong> v SQL, kter√© prov√°dƒõj√≠ v√Ωpoƒçty nebo
                    manipulace s daty. Dƒõl√≠ se na dvƒõ hlavn√≠ kategorie:</p>
                <ul>
                    <li><strong>Skal√°rn√≠ funkce:</strong> Pracuj√≠ s jednotliv√Ωmi hodnotami (UPPER, ROUND, NOW)</li>
                    <li><strong>Agregaƒçn√≠ funkce:</strong> Pracuj√≠ se skupinami hodnot (COUNT, SUM, AVG)</li>
                </ul>

                <h2>üìä Agregaƒçn√≠ funkce</h2>
                <p>Zpracov√°vaj√≠ <strong>mno≈æinu hodnot</strong> a vrac√≠ <strong>jednu v√Ωslednou hodnotu</strong>.
                    Obvykle se pou≈æ√≠vaj√≠ s GROUP BY.</p>

                <h3>COUNT ‚Äì poƒçet z√°znam≈Ø</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
-- Poƒçet v≈°ech ≈ô√°dk≈Ø
SELECT COUNT(*) FROM uzivatele;
-- V√Ωsledek: 150

-- Poƒçet nepr√°zdn√Ωch hodnot (ignoruje NULL)
SELECT COUNT(email) FROM uzivatele;
-- Pokud m√° 10 u≈æivatel≈Ø NULL email ‚Üí vr√°t√≠ 140

-- Poƒçet unik√°tn√≠ch hodnot
SELECT COUNT(DISTINCT mesto) FROM uzivatele;
-- Kolik r≈Øzn√Ωch mƒõst je v tabulce</pre>

                <h3>SUM ‚Äì souƒçet</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
-- Celkov√° suma
SELECT SUM(cena) FROM objednavky;
-- V√Ωsledek: 125000.00

-- Suma za urƒçit√© obdob√≠
SELECT SUM(castka) FROM platby WHERE rok = 2025;

-- Suma se GROUP BY
SELECT produkt_id, SUM(mnozstvi) AS celkem_prodano
FROM polozky_objednavky
GROUP BY produkt_id;</pre>

                <h3>AVG ‚Äì pr≈Ømƒõr</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
-- Pr≈Ømƒõrn√Ω vƒõk
SELECT AVG(vek) FROM uzivatele;
-- V√Ωsledek: 28.5

-- Pr≈Ømƒõr zaokrouhlen√Ω
SELECT ROUND(AVG(vek), 1) AS prumerny_vek FROM uzivatele;
-- V√Ωsledek: 28.5

-- Pr≈Ømƒõr s podm√≠nkou
SELECT AVG(hodnoceni) FROM recenze WHERE produkt_id = 42;</pre>

                <h3>MIN a MAX</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
-- Nejni≈æ≈°√≠ a nejvy≈°≈°√≠ cena
SELECT MIN(cena) AS nejlevnejsi, MAX(cena) AS nejdrazsi FROM produkty;
-- V√Ωsledek: nejlevnejsi = 19.90, nejdrazsi = 999.00

-- Nejstar≈°√≠ a nejmlad≈°√≠ u≈æivatel
SELECT MIN(vek), MAX(vek) FROM uzivatele;

-- Funkce pro datum
SELECT MIN(datum_registrace) AS prvni, MAX(datum_registrace) AS posledni
FROM uzivatele;</pre>

                <h3>Agregace s GROUP BY a HAVING</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
-- Poƒçet u≈æivatel≈Ø v ka≈æd√©m mƒõstƒõ
SELECT mesto, COUNT(*) AS pocet
FROM uzivatele
GROUP BY mesto
ORDER BY pocet DESC;

-- V√Ωsledek:
-- +--------+-------+
-- | mesto  | pocet |
-- +--------+-------+
-- | Praha  | 45    |
-- | Brno   | 28    |
-- | ...    | ...   |

-- Jen mƒõsta s v√≠ce ne≈æ 10 u≈æivateli
SELECT mesto, COUNT(*) AS pocet
FROM uzivatele
GROUP BY mesto
HAVING COUNT(*) > 10;</pre>

                <h2>üìù ≈òetƒõzcov√© funkce</h2>

                <h3>Spojen√≠ ≈ôetƒõzc≈Ø</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
-- CONCAT - spojen√≠
SELECT CONCAT(jmeno, ' ', prijmeni) AS cele_jmeno FROM uzivatele;
-- "Jan" + " " + "Nov√°k" ‚Üí "Jan Nov√°k"

-- CONCAT_WS - s oddƒõlovaƒçem (With Separator)
SELECT CONCAT_WS(', ', mesto, ulice, psc) AS adresa FROM adresy;
-- "Praha, Hlavn√≠ 1, 11000"
-- Automaticky vynech√° NULL hodnoty!</pre>

                <h3>D√©lka a pod≈ôetƒõzec</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
-- LENGTH - d√©lka v bajtech
SELECT LENGTH('Ahoj');     -- 4

-- CHAR_LENGTH - d√©lka ve znac√≠ch (d≈Øle≈æit√© pro UTF-8!)
SELECT CHAR_LENGTH('≈ò');   -- 1 (ale LENGTH vr√°t√≠ 2)

-- SUBSTRING (nebo SUBSTR) - v√Ω≈ôez
SELECT SUBSTRING('Ahoj svƒõte', 1, 4);    -- "Ahoj" (od pozice 1, d√©lka 4)
SELECT SUBSTRING('Ahoj svƒõte', 6);        -- "svƒõte" (od pozice 6 do konce)
SELECT SUBSTRING(email, 1, LOCATE('@', email) - 1) AS username FROM uzivatele;
-- Z "jan@email.cz" ‚Üí "jan"</pre>

                <h3>Zmƒõna velikosti p√≠smen</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
SELECT UPPER('ahoj');      -- "AHOJ"
SELECT LOWER('AHOJ');      -- "ahoj"

-- Praktick√© pou≈æit√≠ - hled√°n√≠ bez ohledu na velikost
SELECT * FROM uzivatele WHERE LOWER(email) = LOWER('Jan@Email.CZ');</pre>

                <h3>Nahrazen√≠ a o≈ô√≠znut√≠</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
-- REPLACE - nahrad√≠ v≈°echny v√Ωskyty
SELECT REPLACE('Hello World', 'World', 'SQL');  -- "Hello SQL"
SELECT REPLACE(email, '@', ' [at] ') FROM uzivatele;

-- TRIM - o≈ô√≠zne mezery
SELECT TRIM('   ahoj   ');     -- "ahoj"
SELECT LTRIM('   ahoj');       -- "ahoj" (zleva)
SELECT RTRIM('ahoj   ');       -- "ahoj" (zprava)

-- TRIM s konkr√©tn√≠m znakem
SELECT TRIM(BOTH '-' FROM '---ahoj---');  -- "ahoj"</pre>

                <h3>Pozice a vyhled√°v√°n√≠</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
-- LOCATE - najde pozici (vrac√≠ 0 pokud nenajde)
SELECT LOCATE('@', 'jan@email.cz');     -- 4
SELECT LOCATE('x', 'ahoj');             -- 0 (nenalezeno)

-- INSTR - alias
SELECT INSTR('jan@email.cz', '@');      -- 4

-- LEFT / RIGHT - znaky zleva/zprava
SELECT LEFT('Ahoj', 2);     -- "Ah"
SELECT RIGHT('Ahoj', 2);    -- "oj"</pre>

                <h2>üìÖ Datumov√© a ƒçasov√© funkce</h2>

                <h3>Aktu√°ln√≠ datum a ƒças</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
SELECT NOW();           -- 2025-12-13 22:15:30 (datum + ƒças)
SELECT CURDATE();       -- 2025-12-13 (jen datum)
SELECT CURTIME();       -- 22:15:30 (jen ƒças)
SELECT UNIX_TIMESTAMP();-- 1734127530 (sekundy od 1.1.1970)</pre>

                <h3>Extrakce ƒç√°st√≠ data</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
SELECT YEAR('2025-12-13');     -- 2025
SELECT MONTH('2025-12-13');    -- 12
SELECT DAY('2025-12-13');      -- 13
SELECT DAYOFWEEK('2025-12-13');-- 7 (1=nedƒõle, 7=sobota)
SELECT DAYNAME('2025-12-13');  -- Saturday

SELECT HOUR('22:15:30');       -- 22
SELECT MINUTE('22:15:30');     -- 15
SELECT SECOND('22:15:30');     -- 30</pre>

                <h3>Form√°tov√°n√≠ data</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
-- DATE_FORMAT - vlastn√≠ form√°t
SELECT DATE_FORMAT(NOW(), '%d.%m.%Y');           -- 13.12.2025
SELECT DATE_FORMAT(NOW(), '%d. %M %Y');          -- 13. December 2025
SELECT DATE_FORMAT(NOW(), '%H:%i');              -- 22:15

-- Form√°tovac√≠ znaƒçky:
-- %Y = rok 4 ƒç√≠slice (2025)
-- %m = mƒõs√≠c (01-12)
-- %d = den (01-31)
-- %H = hodina 24h (00-23)
-- %i = minuty (00-59)
-- %M = n√°zev mƒõs√≠ce (December)</pre>

                <h3>V√Ωpoƒçty s daty</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
-- DATEDIFF - rozd√≠l ve dnech
SELECT DATEDIFF(NOW(), datum_registrace) AS dnu_od_registrace FROM uzivatele;
-- Kolik dn√≠ je u≈æivatel registrov√°n

-- DATE_ADD / DATE_SUB - p≈ôid√°n√≠/odebr√°n√≠
SELECT DATE_ADD(NOW(), INTERVAL 7 DAY);     -- Za t√Ωden
SELECT DATE_ADD(NOW(), INTERVAL 1 MONTH);   -- Za mƒõs√≠c
SELECT DATE_SUB(NOW(), INTERVAL 1 YEAR);    -- P≈ôed rokem

-- Praktick√© pou≈æit√≠
SELECT * FROM platby 
WHERE datum BETWEEN DATE_SUB(CURDATE(), INTERVAL 30 DAY) AND CURDATE();
-- Platby za posledn√≠ch 30 dn√≠</pre>

                <h2>üî¢ Numerick√© funkce</h2>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
-- Zaokrouhlov√°n√≠
SELECT ROUND(3.14159, 2);    -- 3.14 (na 2 desetinn√° m√≠sta)
SELECT CEIL(3.1);            -- 4 (nahoru)
SELECT FLOOR(3.9);           -- 3 (dol≈Ø)
SELECT TRUNCATE(3.14159, 2); -- 3.14 (usekne bez zaokrouhlen√≠)

-- Absolutn√≠ hodnota
SELECT ABS(-5);              -- 5

-- Zbytek po dƒõlen√≠
SELECT MOD(10, 3);           -- 1 (10 dƒõleno 3 = 3, zbytek 1)

-- N√°hodn√© ƒç√≠slo
SELECT RAND();               -- N√°hodn√© desetinn√© 0-1
SELECT FLOOR(RAND() * 100);  -- N√°hodn√© cel√© 0-99</pre>

                <h2>‚ùì Podm√≠nkov√© funkce</h2>
                <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">
-- IF (podm√≠nka, hodnota_pravda, hodnota_nepravda)
SELECT IF(vek >= 18, 'dospƒõl√Ω', 'nezletil√Ω') AS status FROM uzivatele;

-- IFNULL - n√°hrada za NULL
SELECT IFNULL(telefon, 'neuvedeno') FROM uzivatele;
-- Pokud je telefon NULL, vr√°t√≠ 'neuvedeno'

-- NULLIF - vr√°t√≠ NULL pokud jsou hodnoty stejn√©
SELECT NULLIF(hodnota, 0);
-- Pokud hodnota = 0, vr√°t√≠ NULL (u≈æiteƒçn√© pro dƒõlen√≠)

-- CASE - v√≠ceslovn√° podm√≠nka
SELECT jmeno,
    CASE 
        WHEN vek < 18 THEN 'nezletil√Ω'
        WHEN vek < 65 THEN 'dospƒõl√Ω'
        ELSE 'senior'
    END AS kategorie
FROM uzivatele;</pre>

                <h2>üéì Shrnut√≠ pro maturitu</h2>
                <div
                    style="background: rgba(139, 92, 246, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                    <ul>
                        <li><strong>Agregaƒçn√≠:</strong> COUNT, SUM, AVG, MIN, MAX ‚Äì pracuj√≠ se skupinami</li>
                        <li><strong>≈òetƒõzcov√©:</strong> CONCAT, LENGTH, UPPER/LOWER, SUBSTRING, REPLACE, TRIM</li>
                        <li><strong>Datumov√©:</strong> NOW, CURDATE, YEAR/MONTH/DAY, DATE_FORMAT, DATEDIFF</li>
                        <li><strong>Numerick√©:</strong> ROUND, CEIL, FLOOR, ABS, MOD, RAND</li>
                        <li><strong>Podm√≠nkov√©:</strong> IF, IFNULL, CASE</li>
                        <li>COUNT(*) poƒç√≠t√° v≈°e, COUNT(sloupec) ignoruje NULL</li>
                    </ul>
                </div>
            </div>
        </main>
        <footer>
            <p>¬© 2025 MaturitaPort√°l | Vytvo≈ôeno pro p≈ô√≠pravu na maturitu</p>
            <p style="margin-top: 0.5rem; font-size: 0.85rem;">
                <a href="privacy.html" style="color: var(--text-muted);">Z√°sady ochrany osobn√≠ch √∫daj≈Ø</a> | 
                <a href="mailto:prasecibota@gmail.com" style="color: var(--text-muted);">Kontakt</a>
            </p>
        </footer>
    </div>
    <script src="../../script.js"></script>
</body>

</html>