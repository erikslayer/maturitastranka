<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Z√°kladn√≠ syntaxe VBA - Visual Basic for Applications.">
    <title>14. Z√°kladn√≠ syntaxe VBA - PRG | Maturita Port√°l</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../../styles.css">
</head>

<body>
    <div class="container">
        <header>
            <a href="../../index.html" class="logo">MaturitaPort√°l</a>
            <nav>
                <ul>
                    <li><a href="../../index.html">Dom≈Ø</a></li>
                    <li><a href="../../literatura/index.html">Literatura</a></li>
                    <li><a href="../index.html" class="active">ICT</a></li>
                </ul>
            </nav>
        </header>
        <main>
            <nav class="breadcrumb">
                <a href="../../index.html">Dom≈Ø</a><span class="separator">‚Ä∫</span>
                <a href="../index.html">ICT</a><span class="separator">‚Ä∫</span>
                <a href="../prg.html">Programov√°n√≠</a><span class="separator">‚Ä∫</span>
                <span class="current">Z√°kladn√≠ syntaxe VBA</span>
            </nav>
            <div class="book-header animate-fade-in">
                <h1>üìä Z√°kladn√≠ syntaxe VBA</h1>
                <p class="author">T√©ma 14 - Programov√°n√≠</p>
                <div class="meta">
                    <span class="meta-item">üíª Programov√°n√≠</span>
                    <span class="meta-item">üìö Maturitn√≠ okruh</span>
                </div>
            </div>
            <div class="glass-panel animate-fade-in book-content">
                <h2>üìñ Co je VBA?</h2>
                <p><strong>Visual Basic for Applications (VBA)</strong> je programovac√≠ jazyk integrovan√Ω do aplikac√≠
                    Microsoft Office (Excel, Word, Access...). Umo≈æ≈àuje <strong>automatizovat opakuj√≠c√≠ se
                        √∫koly</strong> a vytv√°≈ôet vlastn√≠ funkce.</p>

                <p><strong>üí° Typick√© pou≈æit√≠:</strong></p>
                <ul>
                    <li>Automatizace zpracov√°n√≠ dat v Excelu</li>
                    <li>Generov√°n√≠ sestav a report≈Ø</li>
                    <li>Vytv√°≈ôen√≠ vlastn√≠ch formul√°≈ô≈Ø (UserForms)</li>
                    <li>Propojen√≠ Office aplikac√≠ s datab√°zemi</li>
                </ul>

                <h3>Kde ps√°t VBA k√≥d?</h3>
                <p>V Excelu: <strong>Alt + F11</strong> ‚Üí otev≈ôe VBA Editor. K√≥d se ukl√°d√° do modul≈Ø (Insert ‚Üí Module).
                </p>

                <h2>Sub a Function</h2>
                <p>VBA rozli≈°uje dva typy procedur:</p>

                <h3>Sub (Subroutine) ‚Äì procedura</h3>
                <p>Provede akce, <strong>nevrac√≠ hodnotu</strong>. Lze spustit jako makro.</p>
                <pre class="language-vb"><code>Sub Pozdrav()
    MsgBox "Ahoj svƒõte!"          ' Zobraz√≠ dialog
End Sub

Sub PozdravSJmenem(jmeno As String)
    MsgBox "Ahoj, " & jmeno & "!"  ' & spojuje ≈ôetƒõzce
End Sub

' Vol√°n√≠ procedury
Call PozdravSJmenem("Jan")
' nebo bez Call
PozdravSJmenem "Jan"</code></pre>

                <h3>Function ‚Äì funkce</h3>
                <p><strong>Vrac√≠ hodnotu</strong>. Lze pou≈æ√≠t p≈ô√≠mo v bu≈àk√°ch Excelu jako vlastn√≠ funkci.</p>
                <pre class="language-vb"><code>Function Secti(a As Integer, b As Integer) As Integer
    Secti = a + b                  ' P≈ôi≈ôazen√≠ do n√°zvu = n√°vratov√° hodnota
End Function

Function JeParne(cislo As Integer) As Boolean
    JeParne = (cislo Mod 2 = 0)
End Function

' V Excelu pak m≈Ø≈æe≈° pou≈æ√≠t: =Secti(5, 3) ‚Üí 8
' Vol√°n√≠ v k√≥du:
Dim vysledek As Integer
vysledek = Secti(10, 20)          ' vysledek = 30</code></pre>

                <h2>Promƒõnn√© a datov√© typy</h2>
                <pre class="language-vb"><code>' Deklarace promƒõnn√Ωch (Dim = Dimension)
Dim jmeno As String
Dim vek As Integer
Dim cena As Double
Dim aktivni As Boolean
Dim datum As Date
Dim cokoliv As Variant             ' M≈Ø≈æe obsahovat jak√Ωkoliv typ

' P≈ôi≈ôazen√≠ hodnot
jmeno = "Jan Nov√°k"
vek = 25
cena = 199.90
aktivni = True
datum = #12/13/2025#               ' Datum ve speci√°ln√≠m form√°tu
datum = Date                       ' Aktu√°ln√≠ datum

' Konstanty
Const PI As Double = 3.14159
Const MAX_HODNOTA As Integer = 100</code></pre>

                <table style="width: 100%; border-collapse: collapse; margin: 1rem 0; font-size: 0.9rem;">
                    <tr style="background: rgba(255,255,255,0.1);">
                        <th style="padding: 0.5rem;">Typ</th>
                        <th style="padding: 0.5rem;">Popis</th>
                        <th style="padding: 0.5rem;">Rozsah</th>
                    </tr>
                    <tr>
                        <td style="padding: 0.5rem;"><code>Integer</code></td>
                        <td style="padding: 0.5rem;">Cel√© ƒç√≠slo</td>
                        <td style="padding: 0.5rem;">-32,768 a≈æ 32,767</td>
                    </tr>
                    <tr>
                        <td style="padding: 0.5rem;"><code>Long</code></td>
                        <td style="padding: 0.5rem;">Dlouh√© cel√© ƒç√≠slo</td>
                        <td style="padding: 0.5rem;">¬±2 miliardy</td>
                    </tr>
                    <tr>
                        <td style="padding: 0.5rem;"><code>Double</code></td>
                        <td style="padding: 0.5rem;">Desetinn√© ƒç√≠slo</td>
                        <td style="padding: 0.5rem;">P≈ôesn√° desetinn√°</td>
                    </tr>
                    <tr>
                        <td style="padding: 0.5rem;"><code>String</code></td>
                        <td style="padding: 0.5rem;">Text</td>
                        <td style="padding: 0.5rem;">A≈æ 2 miliardy znak≈Ø</td>
                    </tr>
                    <tr>
                        <td style="padding: 0.5rem;"><code>Boolean</code></td>
                        <td style="padding: 0.5rem;">Pravda/Nepravda</td>
                        <td style="padding: 0.5rem;">True / False</td>
                    </tr>
                    <tr>
                        <td style="padding: 0.5rem;"><code>Date</code></td>
                        <td style="padding: 0.5rem;">Datum a ƒças</td>
                        <td style="padding: 0.5rem;">1.1.100 a≈æ 31.12.9999</td>
                    </tr>
                    <tr>
                        <td style="padding: 0.5rem;"><code>Variant</code></td>
                        <td style="padding: 0.5rem;">Cokoliv</td>
                        <td style="padding: 0.5rem;">Pomalej≈°√≠, univerz√°ln√≠</td>
                    </tr>
                </table>

                <h2>Podm√≠nky (If, Select Case)</h2>
                <pre class="language-vb"><code>' If...Then...Else
Dim vek As Integer
vek = 18

If vek >= 18 Then
    MsgBox "Dospƒõl√Ω"
ElseIf vek >= 15 Then
    MsgBox "Mladistv√Ω"
Else
    MsgBox "D√≠tƒõ"
End If

' Jedno≈ô√°dkov√Ω If
If vek >= 18 Then MsgBox "Dospƒõl√Ω"

' Select Case (jako switch)
Dim den As Integer
den = Weekday(Date)              ' 1 = nedƒõle, 7 = sobota

Select Case den
    Case 1
        MsgBox "Nedƒõle"
    Case 2 To 6                  ' Rozsah hodnot
        MsgBox "Pracovn√≠ den"
    Case 7
        MsgBox "Sobota"
    Case Else
        MsgBox "Neplatn√Ω den"
End Select</code></pre>

                <h2>Cykly</h2>
                <pre class="language-vb"><code>' For...Next
Dim i As Integer
For i = 1 To 10
    Debug.Print i                ' Vyp√≠≈°e do Immediate Window
Next i

For i = 10 To 1 Step -1          ' Zpƒõtnƒõ
    Debug.Print i
Next i

' For Each (pro kolekce)
Dim bunka As Range
For Each bunka In Range("A1:A10")
    bunka.Value = bunka.Value * 2
Next bunka

' Do While...Loop
Dim pocet As Integer
pocet = 0
Do While pocet < 5
    pocet = pocet + 1
    Debug.Print pocet
Loop

' Do...Loop Until (podm√≠nka na konci)
Do
    pocet = pocet + 1
Loop Until pocet >= 10

' Exit For / Exit Do - p≈ôedƒçasn√© ukonƒçen√≠
For i = 1 To 100
    If i = 50 Then Exit For
Next i</code></pre>

                <h2>Pr√°ce s Excelem</h2>

                <h3>P≈ô√≠stup k bu≈àk√°m</h3>
                <pre class="language-vb"><code>' Range objekt - adresa bu≈àky
Range("A1").Value = "Ahoj"            ' Z√°pis hodnoty
Dim hodnota As Variant
hodnota = Range("B2").Value           ' ƒåten√≠ hodnoty

' Cells objekt - ≈ô√°dek, sloupec (ƒç√≠selnƒõ)
Cells(1, 1).Value = "A1"              ' Cells(≈ô√°dek, sloupec)
Cells(2, 3).Value = "C2"              ' C2

' Oblast bunƒõk
Range("A1:D10").Value = 0             ' Vypln√≠ oblast nulami
Range("A1:A10").ClearContents         ' Sma≈æe obsah

' Aktivn√≠ bu≈àka
ActiveCell.Value = "Jsem aktivn√≠"

' V√Ωbƒõr
Range("A1").Select                    ' Vybere bu≈àku
Selection.Font.Bold = True            ' Tuƒçn√© p√≠smo v√Ωbƒõru</code></pre>

                <h3>Form√°tov√°n√≠</h3>
                <pre class="language-vb"><code>With Range("A1")
    .Font.Bold = True
    .Font.Size = 14
    .Font.Color = RGB(255, 0, 0)      ' ƒåerven√°
    .Interior.Color = RGB(255, 255, 0) ' ≈Ωlut√© pozad√≠
    .HorizontalAlignment = xlCenter
End With</code></pre>

                <h3>Pr√°ce s listy</h3>
                <pre class="language-vb"><code>' P≈ô√≠stup k listu
Sheets("List1").Range("A1").Value = "Data"
Worksheets(1).Activate                ' Aktivuje prvn√≠ list

' P≈ôid√°n√≠ nov√©ho listu
Sheets.Add.Name = "NovyList"

' Kop√≠rov√°n√≠ a maz√°n√≠
Sheets("List1").Copy After:=Sheets("List2")
Sheets("Star√ΩList").Delete</code></pre>

                <h2>O≈°et≈ôen√≠ chyb</h2>
                <pre class="language-vb"><code>Sub BezpecnaOperace()
    On Error GoTo ObsluzChybu        ' P≈ôi chybƒõ skoƒç na n√°vƒõ≈°t√≠
    
    Dim vysledek As Double
    vysledek = 10 / 0                 ' Chyba! Dƒõlen√≠ nulou
    
    Exit Sub                          ' Norm√°ln√≠ konec
    
ObsluzChybu:
    MsgBox "Nastala chyba: " & Err.Description
    Resume Next                       ' Pokraƒçuj dal≈°√≠m p≈ô√≠kazem
End Sub

' Ignorov√°n√≠ chyb (opatrnƒõ!)
On Error Resume Next
' ... k√≥d kter√Ω m≈Ø≈æe selhat ...
On Error GoTo 0                       ' Obnov√≠ norm√°ln√≠ zpracov√°n√≠</code></pre>

                <h2>Pole (Arrays)</h2>
                <pre class="language-vb"><code>' Statick√© pole
Dim cisla(1 To 5) As Integer
cisla(1) = 10
cisla(2) = 20

' Dynamick√© pole
Dim data() As String
ReDim data(1 To 10)                   ' Nastaven√≠ velikosti
ReDim Preserve data(1 To 20)          ' Zmƒõna velikosti, zachov√° data

' Pole z rozsahu
Dim hodnoty As Variant
hodnoty = Range("A1:A10").Value       ' 2D pole</code></pre>

                <h2>üéì Shrnut√≠ pro maturitu</h2>
                <div
                    style="background: rgba(139, 92, 246, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                    <ul>
                        <li><strong>Sub:</strong> Procedura bez n√°vratov√© hodnoty</li>
                        <li><strong>Function:</strong> Vrac√≠ hodnotu, pou≈æiteln√° v Excelu</li>
                        <li><strong>Dim:</strong> Deklarace promƒõnn√© (Integer, String, Double...)</li>
                        <li><strong>Range("A1"):</strong> P≈ô√≠stup k bu≈àce adresou</li>
                        <li><strong>Cells(1, 1):</strong> P≈ô√≠stup k bu≈àce ƒç√≠selnƒõ</li>
                        <li><strong>For...Next, Do...Loop:</strong> Cykly</li>
                        <li><strong>If...Then...Else, Select Case:</strong> Podm√≠nky</li>
                        <li><strong>On Error:</strong> O≈°et≈ôen√≠ chyb</li>
                    </ul>
                </div>
            </div>
        </main>
        <footer>
            <p>¬© 2025 MaturitaPort√°l | Vytvo≈ôeno pro p≈ô√≠pravu na maturitu</p>
            <p style="margin-top: 0.5rem; font-size: 0.85rem;">
                <a href="privacy.html" style="color: var(--text-muted);">Z√°sady ochrany osobn√≠ch √∫daj≈Ø</a> | 
                <a href="mailto:prasecibota@gmail.com" style="color: var(--text-muted);">Kontakt</a>
            </p>
        </footer>
    </div>
    
    <!-- Prism.js for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="../../script.js"></script>
</body>

</html>